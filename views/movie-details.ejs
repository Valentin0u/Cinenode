<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Détails du film</title>
    <link rel="stylesheet" href="../public/style.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link rel="shortcut icon" href="../public/images/favicon.png" type="image/x-icon">
</head>
<header>
    <%- include ('./partials/header.ejs') %>
</header>
<body>
    <div class="central">
        <h1><%= movie.movietitle %></h1>		
        <div>
            <form action="/movie-details/<%= movie._id %>" method="post" id="details">
                <legend>Modifier le film</legend>
                <label for="movietitle">Titre du film</label>
                <input type="text" name="movietitle" id="movietitle" value="<%= movie.movietitle %>">
                <br>
                <br>
                <label for="movieyear">Année du film</label>
                <input type="text" name="movieyear" id="movieyear" value="<%= movie.movieyear %>">
                <br>
                <br>
                <label for="moviereal">Réalisateur</label>
                <input type="text" name="moviereal" id="moviereal" value="<%= movie.moviereal %>">
                <br>
                <br>
                <label for="moviesynopsis">Synopsis</label>
                <br>
                <br>
                <textarea name="moviesynopsis" id="moviesynopsis" minlength="30 "maxlength="500" value="<%= movie.moviesynopsis %>"><%= movie.moviesynopsis %></textarea>
                <br>
                <br>                
                <button type="submit">Mettre à jour</button>
            </form>
            <button id="btnSuppr">Supprimer</button>
        </div>
    </div>
    <footer>
        <%- include ('./partials/footer.ejs') %>		
    </footer>
    <script>
         var form = document.getElementById("btnSuppr");
         btnSuppr.addEventListener('click', function(){

        var movieId = <%- JSON.stringify(movie._id)%>;
        var url = '/movie-details/' + movieId;
        axios.delete(url)
            .then(function(response) {
                window.location = '/movies';
         })
            .catch(function(error) {
                console.error(error);
            });
        });
    </script>
</body>
</html>